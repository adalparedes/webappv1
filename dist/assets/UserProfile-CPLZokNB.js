import{u as C,r as d,j as e,s as N}from"./index-Dwj1YBkb.js";import{M as D}from"./ModalContainer-eIZwfhKH.js";const A=({user:a,onClose:v})=>{const{session:r,isGuest:x,refreshProfile:w}=C(),[n,l]=d.useState(!1),[p,f]=d.useState(!1),[m,j]=d.useState([]),[y,c]=d.useState(!0),[u,h]=d.useState(null),_=[{id:"early_adopter",icon:"ðŸš€",name:"Early Adopter",color:"#00d2ff",desc:"Pionero del Core V1"},{id:"power_node",icon:"âš¡",name:"Power Node",color:"#00ff88",desc:"+500 comandos ejecutados"},{id:"premium_king",icon:"ðŸ‘‘",name:"Rey/Reina",color:"#ffcc00",desc:"SuscripciÃ³n Ã‰lite activa"},{id:"bug_hunter",icon:"ðŸ•µï¸",name:"Bug Hunter",color:"#ff3131",desc:"ReportÃ³ vulnerabilidades"},{id:"crypto_whale",icon:"ðŸ‹",name:"Whale Node",color:"#627eea",desc:"Inversor de alto volumen"},{id:"verified",icon:"ðŸ›¡ï¸",name:"Verified",color:"#ffffff",desc:"Identidad confirmada"},{id:"tech_master",icon:"ðŸ§ ",name:"Tech Master",color:"#a855f7",desc:"Conocimiento experto"},{id:"social_sync",icon:"ðŸ¤",name:"Social Sync",color:"#ff3e8d",desc:"Miembro activo Discord"},{id:"data_miner",icon:"â›ï¸",name:"Data Miner",color:"#f7931a",desc:"ExtracciÃ³n de intel avanzada"},{id:"speed_demon",icon:"ðŸ’¨",name:"Speed Demon",color:"#00f2ea",desc:"Uso de modelos flash"},{id:"loyal_user",icon:"ðŸ’Ž",name:"Legacy Node",color:"#b9f2ff",desc:"+1 aÃ±o de antigÃ¼edad"},{id:"beta_tester",icon:"ðŸ§ª",name:"Beta Tester",color:"#9dff00",desc:"Acceso a Labs activo"}],[s,b]=d.useState({username:a.username,fullName:a.fullName,gender:a.gender,ageRange:a.ageRange});d.useEffect(()=>{(async()=>{var o;if(c(!0),h(null),x||!((o=r==null?void 0:r.user)!=null&&o.id)){c(!1);return}try{const{data:i,error:g}=await N.from("credit_transactions").select("id, pack_code, credits_delta, amount_usd, payment_method, status, created_at").eq("user_id",r.user.id).order("created_at",{ascending:!1}).limit(10);if(g)throw g;j(i||[])}catch(i){console.error("[PROFILE_LEDGER] Error:",i),h("No se pudo cargar el historial de transacciones.")}finally{c(!1)}})()},[r,x]);const k=async t=>{var o;if(t.preventDefault(),!!((o=r==null?void 0:r.user)!=null&&o.id)){f(!0);try{const{error:i}=await N.from("profiles").update({username:s.username,full_name:s.fullName,gender:s.gender,age_range:s.ageRange}).eq("id",r.user.id);if(i)throw i;await w(),l(!1)}catch(i){alert(i.message)}finally{f(!1)}}},E=t=>{switch(t==null?void 0:t.toLowerCase()){case"completed":case"success":return"text-[#00ff88] bg-[#00ff88]/10 border-[#00ff88]/20";case"pending":return"text-yellow-500 bg-yellow-500/10 border-yellow-500/20";case"failed":case"error":return"text-red-500 bg-red-500/10 border-red-500/20";default:return"text-gray-400 bg-white/5 border-white/10"}};return e.jsx(D,{title:n?"ConfiguraciÃ³n de Nodo":"Identidad & MÃ©ritos",onClose:v,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-[#00d2ff] rounded-full blur-2xl opacity-20 group-hover:opacity-40 transition-opacity"}),e.jsxs("div",{className:"relative w-32 h-32 rounded-full bg-black border-2 border-[#00d2ff]/30 flex items-center justify-center text-5xl font-orbitron font-bold text-[#00d2ff] shadow-[0_0_40px_rgba(0,210,255,0.1)] overflow-hidden",children:[a.username.substring(0,1).toUpperCase(),e.jsx("div",{className:"absolute bottom-0 w-full bg-[#00d2ff]/20 py-1",children:e.jsx("span",{className:"text-[8px] font-bold text-[#00d2ff] uppercase tracking-tighter",children:"Verified"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-orbitron font-bold text-white uppercase tracking-tight",children:a.username}),e.jsxs("p",{className:"text-[10px] text-[#00ff88] font-mono font-bold uppercase tracking-[0.3em] mt-1",children:[a.membership," NODE"]})]}),e.jsxs("div",{className:"w-full space-y-4 pt-4 border-t border-white/5",children:[e.jsx("span",{className:"text-[9px] font-orbitron font-bold text-gray-500 uppercase tracking-[0.2em]",children:"Vitrina de MÃ©rito (12/12)"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:_.map(t=>e.jsxs("div",{className:"relative group/badge cursor-help",children:[e.jsx("div",{className:"w-10 h-10 bg-white/5 border border-white/10 rounded-xl flex items-center justify-center text-lg hover:border-current hover:bg-current/10 transition-all hover:scale-110 active:scale-90",style:{color:t.color},children:t.icon}),e.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-3 w-32 p-3 bg-black border border-white/20 rounded-xl opacity-0 group-hover/badge:opacity-100 transition-all pointer-events-none z-[100] shadow-[0_10px_30px_rgba(0,0,0,0.8)] scale-90 group-hover/badge:scale-100",children:[e.jsx("p",{className:"text-[9px] font-orbitron font-bold text-white uppercase leading-tight mb-1",children:t.name}),e.jsx("p",{className:"text-[8px] text-gray-400 font-mono leading-relaxed",children:t.desc}),e.jsx("div",{className:"absolute bottom-[-6px] left-1/2 -translate-x-1/2 w-3 h-3 bg-black border-r border-b border-white/20 rotate-45"})]})]},t.id))})]}),!n&&e.jsx("button",{onClick:()=>l(!0),className:"w-full py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400 font-mono text-[9px] uppercase hover:text-white transition-all",children:"[ EDITAR IDENTIDAD ]"})]}),e.jsx("div",{className:"md:col-span-2 space-y-8",children:n?e.jsxs("form",{onSubmit:k,className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-mono text-gray-500 uppercase tracking-widest",children:"Username"}),e.jsx("input",{value:s.username,onChange:t=>b({...s,username:t.target.value}),className:"w-full bg-black border border-white/10 rounded-xl p-3 text-xs text-white focus:border-[#00d2ff] outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[9px] font-mono text-gray-500 uppercase tracking-widest",children:"Nombre Completo"}),e.jsx("input",{value:s.fullName,onChange:t=>b({...s,fullName:t.target.value}),className:"w-full bg-black border border-white/10 rounded-xl p-3 text-xs text-white focus:border-[#00d2ff] outline-none"})]})]}),e.jsx("button",{disabled:p,className:"w-full py-4 bg-[#00d2ff] text-black font-orbitron font-bold text-[10px] uppercase rounded-xl hover:bg-white transition-all shadow-[0_0_20px_rgba(0,210,255,0.2)] flex items-center justify-center gap-3",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-black border-t-transparent rounded-full animate-spin"}),"SINCRONIZANDO..."]}):"ACTUALIZAR DATOS"}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:"w-full py-2 text-[9px] font-mono text-gray-600 uppercase",children:"Cancelar"})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/5 border border-white/10 p-5 rounded-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 text-4xl group-hover:opacity-10 transition-opacity",children:"ðŸ’Ž"}),e.jsx("span",{className:"text-[9px] text-gray-500 font-mono uppercase tracking-widest block mb-1",children:"Balance Actual"}),e.jsxs("div",{className:"text-2xl font-orbitron font-bold text-[#00ff88]",children:[a.balance.toFixed(0)," ",e.jsx("span",{className:"text-[10px] opacity-60",children:"CRED"})]})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 p-5 rounded-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 text-4xl group-hover:opacity-10 transition-opacity",children:"ðŸ›°ï¸"}),e.jsx("span",{className:"text-[9px] text-gray-500 font-mono uppercase tracking-widest block mb-1",children:"Status de Enlace"}),e.jsx("div",{className:"text-2xl font-orbitron font-bold text-white uppercase opacity-80",children:a.membership})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-white/5 pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-[#00ff88] rounded-full animate-pulse shadow-[0_0_8px_#00ff88]"}),e.jsx("h4",{className:"text-[10px] font-orbitron font-bold text-white uppercase tracking-widest",children:"Ledger de Actividad"})]})}),e.jsx("div",{className:"space-y-2 max-h-[250px] overflow-y-auto pr-2 custom-scrollbar",children:y?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(t=>e.jsx("div",{className:"h-14 bg-white/5 border border-white/5 animate-pulse rounded-xl"},t))}):u?e.jsx("div",{className:"py-10 text-center text-red-500 font-mono text-[9px] uppercase border border-dashed border-red-500/30 rounded-xl italic",children:u}):m.length===0?e.jsx("div",{className:"py-10 text-center text-gray-600 font-mono text-[9px] uppercase border border-dashed border-white/5 rounded-xl italic",children:"No se detectan registros recientes de capital."}):m.map(t=>{var o;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/[0.02] border border-white/5 rounded-xl hover:bg-white/[0.04] transition-all",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-white uppercase truncate max-w-[150px]",children:((o=t.pack_code)==null?void 0:o.replace(/_/g," "))||"TOP-UP"}),e.jsxs("span",{className:"text-[8px] text-gray-600 font-mono uppercase",children:[t.payment_method," â€¢ ",new Date(t.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-[10px] font-bold text-[#00ff88]",children:["+ ",t.credits_delta," CR ",e.jsxs("span",{className:"text-gray-500 font-mono",children:["($",t.amount_usd,")"]})]}),e.jsx("div",{className:`mt-1 text-[7px] font-mono uppercase px-1.5 py-0.5 rounded border inline-block ${E(t.status)}`,children:t.status})]})]},t.id)})})]})]})})]})})};export{A as default};
